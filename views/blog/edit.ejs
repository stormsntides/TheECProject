<% include ../partials/headerOpen %>

<% include ../partials/headerClose %>
<% include ../partials/navbar-main %>

<main>
  <div class="container">
    <div class="row">
      <form id="post-form" class="col s12" action="/blog/<%= blogpost._id %>?_method=PUT" method="POST">
        <div class="row">
          <div class="input-field col s12 m10">
            <input id="title" name="blogpost[title]" type="text" class="validate" required value="<%= blogpost.title %>">
            <label for="title">Title</label>
          </div>
          <div class="input-field col s12 m2">
            <input id="order" name="blogpost[order]" type="number" min="0" value="<%= blogpost.order %>">
            <label for="order">Order</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <textarea id="full" name="blogpost[full]" class="materialize-textarea"><%= blogpost.content %></textarea>
            <label for="full">Content</label>
          </div>
        </div>
        <button class="btn waves-effect waves-light" type="submit">Update</button>
        <a href="/blog/<%= blogpost._id %>" class="btn waves-effect waves-light">Cancel</a>
      </form>
    </div>
  </div>
</main>

<% include ../partials/copyright %>
<% include ../partials/jquery %>

<script>
  $(function(){
    $("#full").keydown(function(e) {
        if(e.keyCode === 9) { // tab was pressed
            // get caret position/selection
            let start = this.selectionStart;
            let end = this.selectionEnd;
            let $this = $(this);
            let value = $this.val();
            // set textarea value to: text before caret + tab + text after caret
            $this.val(value.substring(0, start)
                        + "\t"
                        + value.substring(end));
            // put caret at right position again (add one for the tab)
            this.selectionStart = this.selectionEnd = start + 1;
            // prevent the focus lose
            e.preventDefault();
        }
    });
  });
</script>

<% include ../partials/footer %>
